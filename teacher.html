<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher Dashboard - SARATHI</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2C3E50">
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #2C3E50;
            --secondary-color: #3498DB;
            --background-color: #ECF0F1;
            --text-color: #34495E;
            --card-bg-color: #FFFFFF;
            --sidebar-width: 250px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            display: flex;
        }

        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--primary-color);
            color: white;
            height: 100vh;
            position: fixed;
            padding-top: 20px;
        }

        .sidebar h2 {
            text-align: center;
            margin-bottom: 30px;
        }

        .sidebar .nav-menu {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        .sidebar .nav-item {
            padding: 15px 20px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .sidebar .nav-item:hover, .sidebar .nav-item.active {
            background-color: var(--secondary-color);
        }

        .main-dashboard-content {
            margin-left: var(--sidebar-width);
            flex-grow: 1;
            padding: 30px;
        }

        .dashboard-view {
            display: none; /* Hidden by default */
        }

        .dashboard-view.active {
            display: block; /* Shown when active */
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        /* Card styles for metrics and charts */
        .card {
            background: var(--card-bg-color);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }

        /* Grid for overview metrics */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        /* Table for student list */
        .student-table {
            width: 100%;
            border-collapse: collapse;
        }

        .student-table th, .student-table td {
            padding: 12px;
            border-bottom: 1px solid #DDD;
            text-align: left;
        }

    </style>
    <style>
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: white;
            font-size: 2em;
        }
    </style>
</head>
<body>
    <div class="loading-overlay" id="loading-overlay">
        <div>Loading...</div>
    </div>

    <aside class="sidebar">
        <h2>SARATHI</h2>
        <ul class="nav-menu">
            <li class="nav-item active" data-view="overview">Class Overview</li>
            <li class="nav-item" data-view="student-list">Student List</li>
            <li class="nav-item" data-view="knowledge-gaps">Knowledge Gaps</li>
            <li class="nav-item" data-view="reports">Generate Reports</li>
        </ul>
    </aside>

    <main class="main-dashboard-content">
        <header class="dashboard-header">
            <h1 id="dashboard-title">Class Overview</h1>
            <select id="class-selector">
                <!-- Class options will be loaded here -->
            </select>
        </header>

        <!-- Class Overview View -->
        <section id="overview-view" class="dashboard-view active">
            <div class="metrics-grid">
                <div class="card">
                    <h4>Avg. Performance</h4>
                    <p id="metric-avg-performance">--%</p>
                </div>
                <div class="card">
                    <h4>Active Students</h4>
                    <p id="metric-active-students">--/--</p>
                </div>
                <div class="card">
                    <h4>Missions Completed</h4>
                    <p id="metric-missions-completed">--</p>
                </div>
                <div class="card">
                    <h4>Knowledge Gaps</h4>
                    <p id="metric-knowledge-gaps">--</p>
                </div>
            </div>
            <div class="card">
                <h3>Subject Performance</h3>
                <canvas id="subject-performance-chart"></canvas>
            </div>
        </section>

        <!-- Knowledge Gaps View -->
        <section id="knowledge-gaps-view" class="dashboard-view">
            <div class="card">
                <h3>Commonly Misunderstood Topics</h3>
                <div id="knowledge-gaps-container">
                    <!-- Analysis results will be dynamically inserted here -->
                </div>
            </div>
        </section>

        <!-- Student List View -->
        <section id="student-list-view" class="dashboard-view">
            <div class="card">
                <table class="student-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Overall Progress</th>
                            <th>Last Active</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="student-list-tbody">
                        <!-- Student rows will be dynamically inserted here -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Reports View -->
        <section id="reports-view" class="dashboard-view">
            <div class="card">
                <h3>Generate a New Report</h3>
                <!-- Report generation form will go here -->
            </div>
            <div class="card">
                <h3>Generated Reports</h3>
                <div id="report-output">
                    <!-- Report content will be displayed here -->
                </div>
            </section>

            <!-- Reports View -->
            <section id="reports-view" class="dashboard-view">
                <div class="card">
                    <h3>Generate a New Report</h3>
                    <!-- Report generation form will go here -->
                </div>
                <div class="card">
                    <h3>Generated Reports</h3>
                    <div id="report-output">
                        <!-- Report content will be displayed here -->
                    </div>
                </div>
            </section>

        </main>

        <!-- Application Scripts -->
        <script type="module" src="./src/components/teacherDashboard.js"></script>
        
        <!-- Main Entry Point for Teacher Dashboard -->
        <script type="module" src="./src/teacher_main.js"></script>

    </body>
    </html>